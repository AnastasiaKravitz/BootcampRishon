<!DOCTYPE html>
<html lang="en">
    <%- include('./partials/head') %>
    <body>
        <%- include('./partials/navbar', {currentPage: 'login'}) %>
        <div class="container">
            <h1 class="text-center">Log In to <City> Sports Website</h1>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Next</button>
                <div id="error-message" class="text-danger mt-3" style="display:none;"></div> <!-- Error message div -->
            </form>
            <div class="text-center mt-3">
                <p>Don't have an account? <a href="/register" class="btn btn-link">Sign Up</a></p>
            </div>
        </div>
        <script src="/path/to/your/javascript.js"></script> <!-- Link to your JS file -->
        <script>
            document.getElementById('login-form').addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent default form submission

                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;

                // Example API call using fetch
                fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Login failed');
                    }
                    return response.json();
                })
                .then(data => {
                    // Handle successful login
                    if (data.isAdmin) {
                        window.location.href = '/profile'; // Redirect to profile if admin
                    } else {
                        window.location.href = '/welcome'; // Redirect to welcome screen
                    }
                })
                .catch(error => {
                    // Handle login failure
                    const errorMessage = document.getElementById('error-message');
                    errorMessage.innerText = 'Email or password are wrong, please sign in again.';
                    errorMessage.style.display = 'block';
                });
            });
        </script>
    </body>
</html>
